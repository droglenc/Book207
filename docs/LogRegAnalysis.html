<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 27 Analysis | Readings for MTH207</title>
  <meta name="description" content="This book contains the readings for MTH207 at Northland College." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 27 Analysis | Readings for MTH207" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://derekogle.com/Book207/" />
  
  <meta property="og:description" content="This book contains the readings for MTH207 at Northland College." />
  <meta name="github-repo" content="droglenc/Book207" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 27 Analysis | Readings for MTH207" />
  
  <meta name="twitter:description" content="This book contains the readings for MTH207 at Northland College." />
  

<meta name="author" content="Derek H. Ogle" />


<meta name="date" content="2021-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="LogRegModels.html"/>
<link rel="next" href="LogRegSummary.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Readings for MTH207</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>FOUNDATIONS</b></span></li>
<li class="chapter" data-level="1" data-path="ModelTypes.html"><a href="ModelTypes.html"><i class="fa fa-check"></i><b>1</b> Model Types &amp; Methods</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ModelTypes.html"><a href="ModelTypes.html#distinguishing-methods"><i class="fa fa-check"></i><b>1.1</b> Distinguishing Methods</a></li>
<li class="chapter" data-level="1.2" data-path="ModelTypes.html"><a href="ModelTypes.html#method-purposes"><i class="fa fa-check"></i><b>1.2</b> Method Purposes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="T2Review.html"><a href="T2Review.html"><i class="fa fa-check"></i><b>2</b> 2-Sample t Review</a>
<ul>
<li class="chapter" data-level="2.1" data-path="T2Review.html"><a href="T2Review.html#review"><i class="fa fa-check"></i><b>2.1</b> Review</a></li>
<li class="chapter" data-level="2.2" data-path="T2Review.html"><a href="T2Review.html#T2analysis"><i class="fa fa-check"></i><b>2.2</b> Analysis in R</a></li>
<li class="chapter" data-level="2.3" data-path="T2Review.html"><a href="T2Review.html#signal-to-noise"><i class="fa fa-check"></i><b>2.3</b> Signal-to-Noise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ModelConcepts.html"><a href="ModelConcepts.html"><i class="fa fa-check"></i><b>3</b> Model Concepts</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ModelConcepts.html"><a href="ModelConcepts.html#what-is-a-model"><i class="fa fa-check"></i><b>3.1</b> What is a Model</a></li>
<li class="chapter" data-level="3.2" data-path="ModelConcepts.html"><a href="ModelConcepts.html#assessing-fit-ss"><i class="fa fa-check"></i><b>3.2</b> Assessing Fit (SS)</a></li>
<li class="chapter" data-level="3.3" data-path="ModelConcepts.html"><a href="ModelConcepts.html#residual-degrees-of-freedom"><i class="fa fa-check"></i><b>3.3</b> Residual Degrees-of-Freedom</a></li>
<li class="chapter" data-level="3.4" data-path="ModelConcepts.html"><a href="ModelConcepts.html#mean-squares"><i class="fa fa-check"></i><b>3.4</b> Mean-Squares</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ModelComparison.html"><a href="ModelComparison.html"><i class="fa fa-check"></i><b>4</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ModelComparison.html"><a href="ModelComparison.html#competing-models"><i class="fa fa-check"></i><b>4.1</b> Competing Models</a></li>
<li class="chapter" data-level="4.2" data-path="ModelComparison.html"><a href="ModelComparison.html#measuring-increase-in-fit"><i class="fa fa-check"></i><b>4.2</b> Measuring Increase in Fit</a></li>
<li class="chapter" data-level="4.3" data-path="ModelComparison.html"><a href="ModelComparison.html#measuring-increase-in-complexity"><i class="fa fa-check"></i><b>4.3</b> Measuring Increase in Complexity</a></li>
<li class="chapter" data-level="4.4" data-path="ModelComparison.html"><a href="ModelComparison.html#noise-variances"><i class="fa fa-check"></i><b>4.4</b> “Noise” Variances</a></li>
<li class="chapter" data-level="4.5" data-path="ModelComparison.html"><a href="ModelComparison.html#signal-variance-benefit-to-cost"><i class="fa fa-check"></i><b>4.5</b> “Signal” Variance (Benefit-to-Cost)</a></li>
<li class="chapter" data-level="4.6" data-path="ModelComparison.html"><a href="ModelComparison.html#ratio-of-variances-signal-to-noise"><i class="fa fa-check"></i><b>4.6</b> Ratio of Variances (Signal-to-Noise)</a></li>
<li class="chapter" data-level="4.7" data-path="ModelComparison.html"><a href="ModelComparison.html#anova-table"><i class="fa fa-check"></i><b>4.7</b> ANOVA Table</a></li>
<li class="chapter" data-level="4.8" data-path="ModelComparison.html"><a href="ModelComparison.html#two-sample-t-test-revisited-using-linear-models"><i class="fa fa-check"></i><b>4.8</b> Two-Sample t-Test Revisited: Using Linear Models</a></li>
<li class="chapter" data-level="4.9" data-path="ModelComparison.html"><a href="ModelComparison.html#one-more-look-at-ms-and-f-test"><i class="fa fa-check"></i><b>4.9</b> One More Look at MS and F-test</a></li>
</ul></li>
<li class="part"><span><b>ONE-WAY ANOVA</b></span></li>
<li class="chapter" data-level="5" data-path="ANOVA1Foundations.html"><a href="ANOVA1Foundations.html"><i class="fa fa-check"></i><b>5</b> One-Way Foundations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ANOVA1Foundations.html"><a href="ANOVA1Foundations.html#analytical-foundation"><i class="fa fa-check"></i><b>5.1</b> Analytical Foundation</a></li>
<li class="chapter" data-level="5.2" data-path="ANOVA1Foundations.html"><a href="ANOVA1Foundations.html#one-way-anova-in-r"><i class="fa fa-check"></i><b>5.2</b> One-Way ANOVA in R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ANOVA1MultipleComparisons.html"><a href="ANOVA1MultipleComparisons.html"><i class="fa fa-check"></i><b>6</b> One-Way Multiple Comparisons</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ANOVA1MultipleComparisons.html"><a href="ANOVA1MultipleComparisons.html#multiple-comparison-problem"><i class="fa fa-check"></i><b>6.1</b> Multiple Comparison Problem</a></li>
<li class="chapter" data-level="6.2" data-path="ANOVA1MultipleComparisons.html"><a href="ANOVA1MultipleComparisons.html#correction-methods"><i class="fa fa-check"></i><b>6.2</b> Correction Methods</a></li>
<li class="chapter" data-level="6.3" data-path="ANOVA1MultipleComparisons.html"><a href="ANOVA1MultipleComparisons.html#multiple-comparisons-in-r"><i class="fa fa-check"></i><b>6.3</b> Multiple Comparisons in R</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html"><i class="fa fa-check"></i><b>7</b> One-Way Assumptions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html#independence"><i class="fa fa-check"></i><b>7.1</b> Independence</a></li>
<li class="chapter" data-level="7.2" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html#equal-variances"><i class="fa fa-check"></i><b>7.2</b> Equal Variances</a></li>
<li class="chapter" data-level="7.3" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html#normality"><i class="fa fa-check"></i><b>7.3</b> Normality</a></li>
<li class="chapter" data-level="7.4" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html#no-outliers"><i class="fa fa-check"></i><b>7.4</b> No Outliers</a></li>
<li class="chapter" data-level="7.5" data-path="ANOVA1Assumptions.html"><a href="ANOVA1Assumptions.html#testing-assumptions-in-r"><i class="fa fa-check"></i><b>7.5</b> Testing Assumptions in R</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ANOVA1Transformations.html"><a href="ANOVA1Transformations.html"><i class="fa fa-check"></i><b>8</b> One-Way Transformations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ANOVA1Transformations.html"><a href="ANOVA1Transformations.html#power-transformations"><i class="fa fa-check"></i><b>8.1</b> Power Transformations</a></li>
<li class="chapter" data-level="8.2" data-path="ANOVA1Transformations.html"><a href="ANOVA1Transformations.html#transformations-from-theory"><i class="fa fa-check"></i><b>8.2</b> Transformations from Theory</a></li>
<li class="chapter" data-level="8.3" data-path="ANOVA1Transformations.html"><a href="ANOVA1Transformations.html#interpretations-after-transformations"><i class="fa fa-check"></i><b>8.3</b> Interpretations After Transformations</a></li>
<li class="chapter" data-level="8.4" data-path="ANOVA1Transformations.html"><a href="ANOVA1Transformations.html#back-transformations-in-r"><i class="fa fa-check"></i><b>8.4</b> Back-Transformations in R</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ANOVA1Summary.html"><a href="ANOVA1Summary.html"><i class="fa fa-check"></i><b>9</b> One-Way Summary</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ANOVA1Summary.html"><a href="ANOVA1Summary.html#suggested-workflow"><i class="fa fa-check"></i><b>9.1</b> Suggested Workflow</a></li>
<li class="chapter" data-level="9.2" data-path="ANOVA1Summary.html"><a href="ANOVA1Summary.html#nematodes-no-transformation"><i class="fa fa-check"></i><b>9.2</b> Nematodes (<em>No Transformation</em>)</a></li>
<li class="chapter" data-level="9.3" data-path="ANOVA1Summary.html"><a href="ANOVA1Summary.html#ant-foraging-transformation"><i class="fa fa-check"></i><b>9.3</b> Ant Foraging (<em>Transformation</em>)</a></li>
<li class="chapter" data-level="9.4" data-path="ANOVA1Summary.html"><a href="ANOVA1Summary.html#peak-discharge-transformation"><i class="fa fa-check"></i><b>9.4</b> Peak Discharge (<em>Transformation</em>)</a></li>
</ul></li>
<li class="part"><span><b>TWO-WAY ANOVA</b></span></li>
<li class="chapter" data-level="10" data-path="ANOVA2Foundations1.html"><a href="ANOVA2Foundations1.html"><i class="fa fa-check"></i><b>10</b> Two-Way Conceptual Foundation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ANOVA2Foundations1.html"><a href="ANOVA2Foundations1.html#two-factors"><i class="fa fa-check"></i><b>10.1</b> Two Factors</a></li>
<li class="chapter" data-level="10.2" data-path="ANOVA2Foundations1.html"><a href="ANOVA2Foundations1.html#interaction-effects"><i class="fa fa-check"></i><b>10.2</b> Interaction Effects</a></li>
<li class="chapter" data-level="10.3" data-path="ANOVA2Foundations1.html"><a href="ANOVA2Foundations1.html#main-effects"><i class="fa fa-check"></i><b>10.3</b> Main Effects</a></li>
<li class="chapter" data-level="10.4" data-path="ANOVA2Foundations1.html"><a href="ANOVA2Foundations1.html#advantages-of-ccfd"><i class="fa fa-check"></i><b>10.4</b> Advantages of CCFD</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ANOVA2Foundations2.html"><a href="ANOVA2Foundations2.html"><i class="fa fa-check"></i><b>11</b> Two-Way Analytical Foundation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ANOVA2Foundations2.html"><a href="ANOVA2Foundations2.html#terminology"><i class="fa fa-check"></i><b>11.1</b> Terminology</a></li>
<li class="chapter" data-level="11.2" data-path="ANOVA2Foundations2.html"><a href="ANOVA2Foundations2.html#total-and-within-ss-df-and-ms"><i class="fa fa-check"></i><b>11.2</b> Total and Within SS, df, and MS</a></li>
<li class="chapter" data-level="11.3" data-path="ANOVA2Foundations2.html"><a href="ANOVA2Foundations2.html#among-ss-df-and-ms"><i class="fa fa-check"></i><b>11.3</b> Among SS, df, and MS</a></li>
<li class="chapter" data-level="11.4" data-path="ANOVA2Foundations2.html"><a href="ANOVA2Foundations2.html#anova-table-1"><i class="fa fa-check"></i><b>11.4</b> ANOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html"><i class="fa fa-check"></i><b>12</b> Two-Way Analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html#model-fitting-in-r"><i class="fa fa-check"></i><b>12.1</b> Model Fitting in R</a></li>
<li class="chapter" data-level="12.2" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html#assumptions"><i class="fa fa-check"></i><b>12.2</b> Assumptions</a></li>
<li class="chapter" data-level="12.3" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html#main-and-interaction-effects-anova-table"><i class="fa fa-check"></i><b>12.3</b> Main and Interaction Effects (ANOVA Table)</a></li>
<li class="chapter" data-level="12.4" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html#multiple-comparisons"><i class="fa fa-check"></i><b>12.4</b> Multiple Comparisons</a></li>
<li class="chapter" data-level="12.5" data-path="ANOVA2Analysis.html"><a href="ANOVA2Analysis.html#graphing-results"><i class="fa fa-check"></i><b>12.5</b> Graphing Results</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ANOVA2Summary.html"><a href="ANOVA2Summary.html"><i class="fa fa-check"></i><b>13</b> Two-Way Summary</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ANOVA2Summary.html"><a href="ANOVA2Summary.html#suggested-workflow-1"><i class="fa fa-check"></i><b>13.1</b> Suggested Workflow</a></li>
<li class="chapter" data-level="13.2" data-path="ANOVA2Summary.html"><a href="ANOVA2Summary.html#expected-prices-no-transformation"><i class="fa fa-check"></i><b>13.2</b> Expected Prices (<em>No Transformation</em>)</a></li>
<li class="chapter" data-level="13.3" data-path="ANOVA2Summary.html"><a href="ANOVA2Summary.html#blood-pressure-no-transformation"><i class="fa fa-check"></i><b>13.3</b> Blood Pressure (<em>No Transformation</em>)</a></li>
<li class="chapter" data-level="13.4" data-path="ANOVA2Summary.html"><a href="ANOVA2Summary.html#crayfish-foraging-transformation"><i class="fa fa-check"></i><b>13.4</b> Crayfish Foraging (<em>Transformation</em>)</a></li>
</ul></li>
<li class="part"><span><b>SIMPLE LINEAR REGRESSION</b></span></li>
<li class="chapter" data-level="14" data-path="SLRFoundations.html"><a href="SLRFoundations.html"><i class="fa fa-check"></i><b>14</b> SLR Foundational Principles</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SLRFoundations.html"><a href="SLRFoundations.html#equation-of-a-line"><i class="fa fa-check"></i><b>14.1</b> Equation of a Line</a></li>
<li class="chapter" data-level="14.2" data-path="SLRFoundations.html"><a href="SLRFoundations.html#best-fit-line"><i class="fa fa-check"></i><b>14.2</b> Best-Fit Line</a></li>
<li class="chapter" data-level="14.3" data-path="SLRFoundations.html"><a href="SLRFoundations.html#best-fit-line-in-r"><i class="fa fa-check"></i><b>14.3</b> Best-Fit Line in R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SLRInference.html"><a href="SLRInference.html"><i class="fa fa-check"></i><b>15</b> SLR Inference</a>
<ul>
<li class="chapter" data-level="15.1" data-path="SLRInference.html"><a href="SLRInference.html#variability-around-the-line"><i class="fa fa-check"></i><b>15.1</b> Variability Around the Line</a></li>
<li class="chapter" data-level="15.2" data-path="SLRInference.html"><a href="SLRInference.html#slope"><i class="fa fa-check"></i><b>15.2</b> Slope</a></li>
<li class="chapter" data-level="15.3" data-path="SLRInference.html"><a href="SLRInference.html#intercept"><i class="fa fa-check"></i><b>15.3</b> Intercept</a></li>
<li class="chapter" data-level="15.4" data-path="SLRInference.html"><a href="SLRInference.html#slope-and-intercept-in-r"><i class="fa fa-check"></i><b>15.4</b> Slope and Intercept in R</a></li>
<li class="chapter" data-level="15.5" data-path="SLRInference.html"><a href="SLRInference.html#predicting-means"><i class="fa fa-check"></i><b>15.5</b> Predicting Means</a></li>
<li class="chapter" data-level="15.6" data-path="SLRInference.html"><a href="SLRInference.html#predicting-individuals"><i class="fa fa-check"></i><b>15.6</b> Predicting Individuals</a></li>
<li class="chapter" data-level="15.7" data-path="SLRInference.html"><a href="SLRInference.html#predictions-in-r"><i class="fa fa-check"></i><b>15.7</b> Predictions in R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="SLRModels.html"><a href="SLRModels.html"><i class="fa fa-check"></i><b>16</b> SLR Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="SLRModels.html"><a href="SLRModels.html#models-1"><i class="fa fa-check"></i><b>16.1</b> Models</a></li>
<li class="chapter" data-level="16.2" data-path="SLRModels.html"><a href="SLRModels.html#anova-table-2"><i class="fa fa-check"></i><b>16.2</b> ANOVA Table</a></li>
<li class="chapter" data-level="16.3" data-path="SLRModels.html"><a href="SLRModels.html#coefficient-of-determination"><i class="fa fa-check"></i><b>16.3</b> Coefficient Of Determination</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html"><i class="fa fa-check"></i><b>17</b> SLR Assumptions</a>
<ul>
<li class="chapter" data-level="17.1" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#residual-plot"><i class="fa fa-check"></i><b>17.1</b> Residual Plot</a></li>
<li class="chapter" data-level="17.2" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#independence-1"><i class="fa fa-check"></i><b>17.2</b> Independence</a></li>
<li class="chapter" data-level="17.3" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#homoscedasticity"><i class="fa fa-check"></i><b>17.3</b> Homoscedasticity</a></li>
<li class="chapter" data-level="17.4" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#SLRNormality"><i class="fa fa-check"></i><b>17.4</b> Normality</a></li>
<li class="chapter" data-level="17.5" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#SLRNoOutliers"><i class="fa fa-check"></i><b>17.5</b> No Outliers or Influential Points</a></li>
<li class="chapter" data-level="17.6" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#linearity"><i class="fa fa-check"></i><b>17.6</b> Linearity</a></li>
<li class="chapter" data-level="17.7" data-path="SLRAssumptions.html"><a href="SLRAssumptions.html#testing-assumptions-in-r-1"><i class="fa fa-check"></i><b>17.7</b> Testing Assumptions in R</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="SLRTransformations.html"><a href="SLRTransformations.html"><i class="fa fa-check"></i><b>18</b> SLR Transformations</a>
<ul>
<li class="chapter" data-level="18.1" data-path="SLRTransformations.html"><a href="SLRTransformations.html#transformations-from-theoretical-relationships"><i class="fa fa-check"></i><b>18.1</b> Transformations from Theoretical Relationships</a></li>
<li class="chapter" data-level="18.2" data-path="SLRTransformations.html"><a href="SLRTransformations.html#trial-and-error-method"><i class="fa fa-check"></i><b>18.2</b> Trial-and-Error Method</a></li>
<li class="chapter" data-level="18.3" data-path="SLRTransformations.html"><a href="SLRTransformations.html#back-transformation-in-slr"><i class="fa fa-check"></i><b>18.3</b> Back-Transformation in SLR</a></li>
<li class="chapter" data-level="18.4" data-path="SLRTransformations.html"><a href="SLRTransformations.html#examples"><i class="fa fa-check"></i><b>18.4</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="SLRSummary.html"><a href="SLRSummary.html"><i class="fa fa-check"></i><b>19</b> SLR Summary</a>
<ul>
<li class="chapter" data-level="19.1" data-path="SLRSummary.html"><a href="SLRSummary.html#suggested-workflow-2"><i class="fa fa-check"></i><b>19.1</b> Suggested Workflow</a></li>
<li class="chapter" data-level="19.2" data-path="SLRSummary.html"><a href="SLRSummary.html#climate-change-data-no-transformation"><i class="fa fa-check"></i><b>19.2</b> Climate Change Data (<em>No Transformation</em>)</a></li>
<li class="chapter" data-level="19.3" data-path="SLRSummary.html"><a href="SLRSummary.html#forest-allometrics-transformation"><i class="fa fa-check"></i><b>19.3</b> Forest Allometrics (Transformation)</a></li>
</ul></li>
<li class="part"><span><b>INDICATOR VARIABLE REGRESSION</b></span></li>
<li class="chapter" data-level="20" data-path="IVRVariables.html"><a href="IVRVariables.html"><i class="fa fa-check"></i><b>20</b> IVR Variables</a>
<ul>
<li class="chapter" data-level="20.1" data-path="IVRVariables.html"><a href="IVRVariables.html#indicator-variables"><i class="fa fa-check"></i><b>20.1</b> Indicator Variables</a></li>
<li class="chapter" data-level="20.2" data-path="IVRVariables.html"><a href="IVRVariables.html#interaction-variables"><i class="fa fa-check"></i><b>20.2</b> Interaction Variables</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="IVRModels.html"><a href="IVRModels.html"><i class="fa fa-check"></i><b>21</b> IVR Models &amp; Sub-Models</a>
<ul>
<li class="chapter" data-level="21.1" data-path="IVRModels.html"><a href="IVRModels.html#ultimate-full-model"><i class="fa fa-check"></i><b>21.1</b> Ultimate Full Model</a></li>
<li class="chapter" data-level="21.2" data-path="IVRModels.html"><a href="IVRModels.html#sub-models"><i class="fa fa-check"></i><b>21.2</b> Sub-Models</a></li>
<li class="chapter" data-level="21.3" data-path="IVRModels.html"><a href="IVRModels.html#interpreting-parameter-estimates"><i class="fa fa-check"></i><b>21.3</b> Interpreting Parameter Estimates</a></li>
<li class="chapter" data-level="21.4" data-path="IVRModels.html"><a href="IVRModels.html#ultimate-full-model-in-r"><i class="fa fa-check"></i><b>21.4</b> Ultimate Full Model in R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="IVRTesting.html"><a href="IVRTesting.html"><i class="fa fa-check"></i><b>22</b> IVR Testing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="IVRTesting.html"><a href="IVRTesting.html#f-ratio-test-statistic"><i class="fa fa-check"></i><b>22.1</b> F-ratio Test Statistic</a></li>
<li class="chapter" data-level="22.2" data-path="IVRTesting.html"><a href="IVRTesting.html#parallel-lines-test"><i class="fa fa-check"></i><b>22.2</b> Parallel Lines Test</a></li>
<li class="chapter" data-level="22.3" data-path="IVRTesting.html"><a href="IVRTesting.html#coincident-lines-test"><i class="fa fa-check"></i><b>22.3</b> Coincident Lines Test</a></li>
<li class="chapter" data-level="22.4" data-path="IVRTesting.html"><a href="IVRTesting.html#relationship-test"><i class="fa fa-check"></i><b>22.4</b> Relationship Test</a></li>
<li class="chapter" data-level="22.5" data-path="IVRTesting.html"><a href="IVRTesting.html#all-tests-in-r"><i class="fa fa-check"></i><b>22.5</b> All Tests in R</a></li>
<li class="chapter" data-level="22.6" data-path="IVRTesting.html"><a href="IVRTesting.html#more-groups-different-slopes"><i class="fa fa-check"></i><b>22.6</b> More Groups (Different Slopes)</a></li>
<li class="chapter" data-level="22.7" data-path="IVRTesting.html"><a href="IVRTesting.html#more-groups-same-slopes"><i class="fa fa-check"></i><b>22.7</b> More Groups (Same Slopes)</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="IVRAnalysis.html"><a href="IVRAnalysis.html"><i class="fa fa-check"></i><b>23</b> IVR Analysis</a>
<ul>
<li class="chapter" data-level="23.1" data-path="IVRAnalysis.html"><a href="IVRAnalysis.html#assumptions-transformations"><i class="fa fa-check"></i><b>23.1</b> Assumptions &amp; Transformations</a></li>
<li class="chapter" data-level="23.2" data-path="IVRAnalysis.html"><a href="IVRAnalysis.html#multiple-comparisons-for-slopes"><i class="fa fa-check"></i><b>23.2</b> Multiple Comparisons for Slopes</a></li>
<li class="chapter" data-level="23.3" data-path="IVRAnalysis.html"><a href="IVRAnalysis.html#multiple-comparisons-for-intercepts"><i class="fa fa-check"></i><b>23.3</b> Multiple Comparisons for Intercepts</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="IVRSummary.html"><a href="IVRSummary.html"><i class="fa fa-check"></i><b>24</b> IVR Summary</a>
<ul>
<li class="chapter" data-level="24.1" data-path="IVRSummary.html"><a href="IVRSummary.html#IVRWorkflow"><i class="fa fa-check"></i><b>24.1</b> Suggested Workflow</a></li>
<li class="chapter" data-level="24.2" data-path="IVRSummary.html"><a href="IVRSummary.html#fish-energy-density-no-transformation"><i class="fa fa-check"></i><b>24.2</b> Fish Energy Density (<em>No Transformation</em>)</a></li>
<li class="chapter" data-level="24.3" data-path="IVRSummary.html"><a href="IVRSummary.html#shrub-allometry-transformation"><i class="fa fa-check"></i><b>24.3</b> Shrub Allometry (<em>Transformation</em>)</a></li>
</ul></li>
<li class="part"><span><b>LOGISTIC REGRESSION</b></span></li>
<li class="chapter" data-level="25" data-path="LogRegFoundations.html"><a href="LogRegFoundations.html"><i class="fa fa-check"></i><b>25</b> Foundational Principles</a>
<ul>
<li class="chapter" data-level="25.1" data-path="LogRegFoundations.html"><a href="LogRegFoundations.html#need-for-a-transformation"><i class="fa fa-check"></i><b>25.1</b> Need for a Transformation</a></li>
<li class="chapter" data-level="25.2" data-path="LogRegFoundations.html"><a href="LogRegFoundations.html#odds"><i class="fa fa-check"></i><b>25.2</b> Odds</a></li>
<li class="chapter" data-level="25.3" data-path="LogRegFoundations.html"><a href="LogRegFoundations.html#log-odds-and-the-logit-transformation"><i class="fa fa-check"></i><b>25.3</b> Log Odds and the Logit Transformation</a></li>
<li class="chapter" data-level="25.4" data-path="LogRegFoundations.html"><a href="LogRegFoundations.html#back-transformation-introduction"><i class="fa fa-check"></i><b>25.4</b> Back-Transformation Introduction</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="LogRegModels.html"><a href="LogRegModels.html"><i class="fa fa-check"></i><b>26</b> Models and Predictions</a>
<ul>
<li class="chapter" data-level="26.1" data-path="LogRegModels.html"><a href="LogRegModels.html#LogRegSlope"><i class="fa fa-check"></i><b>26.1</b> Slope &amp; Back-Transformed Slope</a></li>
<li class="chapter" data-level="26.2" data-path="LogRegModels.html"><a href="LogRegModels.html#back-transformed-slope"><i class="fa fa-check"></i><b>26.2</b> Back-Transformed Slope</a></li>
<li class="chapter" data-level="26.3" data-path="LogRegModels.html"><a href="LogRegModels.html#predictions-1"><i class="fa fa-check"></i><b>26.3</b> Predictions</a></li>
<li class="chapter" data-level="26.4" data-path="LogRegModels.html"><a href="LogRegModels.html#reverse-predictions"><i class="fa fa-check"></i><b>26.4</b> “Reverse” Predictions</a></li>
<li class="chapter" data-level="26.5" data-path="LogRegModels.html"><a href="LogRegModels.html#variability-estimates"><i class="fa fa-check"></i><b>26.5</b> Variability Estimates</a></li>
<li class="chapter" data-level="26.6" data-path="LogRegModels.html"><a href="LogRegModels.html#another-example"><i class="fa fa-check"></i><b>26.6</b> Another Example</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html"><i class="fa fa-check"></i><b>27</b> Analysis</a>
<ul>
<li class="chapter" data-level="27.1" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html#data-preparation"><i class="fa fa-check"></i><b>27.1</b> Data Preparation</a></li>
<li class="chapter" data-level="27.2" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html#fitting-the-model"><i class="fa fa-check"></i><b>27.2</b> Fitting the Model</a></li>
<li class="chapter" data-level="27.3" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html#LogRegParametersR"><i class="fa fa-check"></i><b>27.3</b> Parameter Estimates</a></li>
<li class="chapter" data-level="27.4" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html#LogRegPredictionsR"><i class="fa fa-check"></i><b>27.4</b> Predictions</a></li>
<li class="chapter" data-level="27.5" data-path="LogRegAnalysis.html"><a href="LogRegAnalysis.html#plotting-best-fit-line"><i class="fa fa-check"></i><b>27.5</b> Plotting Best-Fit Line</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="LogRegSummary.html"><a href="LogRegSummary.html"><i class="fa fa-check"></i><b>28</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Readings for MTH207</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="LogRegAnalysis" class="section level1" number="27">
<h1><span class="header-section-number">Module 27</span> Analysis</h1>
<p>Modules <a href="LogRegFoundations.html#LogRegFoundations">25</a> and <a href="LogRegModels.html#LogRegModels">26</a> described the basics of fitting a logistic regression and understanding the meanings of the parameter estimates, predicted probabilities, and predicted values of the explanatory variable for a given probability. This module will demonstrate how to perform those analyses using R.</p>
<div id="data-preparation" class="section level2" number="27.1">
<h2><span class="header-section-number">27.1</span> Data Preparation</h2>
<p>Bliss (1935), in a classic study, examined the mortality response of beetles to various concentrations of gaseous carbon disulphide (mg/liter). The concentration and whether or not the beetle survived the exposure to that concentration was recorded for each beetle in Bliss.csv (<a href="https://raw.githubusercontent.com/droglenc/NCData/master/Bliss.csv">data</a>, <a href="https://github.com/droglenc/NCData/blob/master/Bliss_meta.txt">meta</a>). These data are loaded and briefly examined below.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb190-1"><a href="LogRegAnalysis.html#cb190-1" aria-hidden="true" tabindex="-1"></a>bliss <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/droglenc/NCData/master/Bliss.csv&quot;</span>)</span>
<span id="cb190-2"><a href="LogRegAnalysis.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bliss)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   &#39;data.frame&#39;: 481 obs. of  2 variables:
#R&gt;    $ outcome: chr  &quot;dead&quot; &quot;dead&quot; &quot;dead&quot; &quot;dead&quot; ...
#R&gt;    $ conc   : num  49.1 49.1 49.1 49.1 49.1 49.1 49.1 49.1 49.1 49.1 ...</code></pre>
<p>In this case, we want to model the probability of mortality (i.e., the beetle died) as a function of the concentration of gaseous carbon disulphide. With this objective, a “success” is a “dead” beetle. Thus, “dead” should be coded as “1” and “not dead” (i.e., “alive”) as a “0.” You will recognize this as an indicator variable from Module <a href="IVRVariables.html#IVRVariables">20</a>. In contrast to when we used indicator variables for factors, we need to explicitly create the indicator variable here when it is used as a response variable.</p>
<p>An indicator variable can be created with <code>ifelse()</code>, which takes a “condition” as its first argument, what should be returned if the condition is “yes” as the second argument, and what should be returned if the condition is “no” as the third argument. The code below creates a new <code>outcome01</code> variable in the <code>bliss</code> data frame that will be <code>1</code> if <code>outcome</code> is <code>dead</code> and <code>0</code> if <code>outcome</code> is not <code>dead</code>.<a href="#fn100" class="footnote-ref" id="fnref100"><sup>100</sup></a></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb192-1"><a href="LogRegAnalysis.html#cb192-1" aria-hidden="true" tabindex="-1"></a>bliss<span class="sc">$</span>outcome01 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bliss<span class="sc">$</span>outcome<span class="sc">==</span><span class="st">&quot;dead&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>You should examine the new variable to make sure that it represents what you intended.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb193-1"><a href="LogRegAnalysis.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bliss,<span class="at">n=</span><span class="dv">8</span>)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;     outcome conc outcome01
#R&gt;   1    dead 49.1         1
#R&gt;   2    dead 49.1         1
#R&gt;   3    dead 49.1         1
#R&gt;   4    dead 49.1         1
#R&gt;   5    dead 49.1         1
#R&gt;   6    dead 49.1         1
#R&gt;   7   alive 49.1         0
#R&gt;   8   alive 49.1         0</code></pre>
<div class="tip">
<p>The binary response variable must be explicitly converted to an indicator variable with <code>ifelse()</code> for constructing a logistic regression and plotting the results in R.</p>
</div>
</div>
<div id="fitting-the-model" class="section level2" number="27.2">
<h2><span class="header-section-number">27.2</span> Fitting the Model</h2>
<p>The logistic regression model is fit with <code>glm()</code>, which is the <strong>generalized linear model</strong> function in R. The first argument to <code>glm()</code> is a formula of the form <code>var01~qvar</code> where <code>var01</code> is the indicator response variable created above and <code>qvar</code> is the quantitative explanatory variable, the data frame that contains these variables is in <code>data=</code>, and <code>family=binomial</code>. The <code>family=binomial</code> argument is critical because that is what tells <code>glm()</code> that the response variable should be treated as an indicator rather than quantitative variable. This signals <code>glm()</code> to fit a logistic regression model. The results of <code>glm()</code> should be saved to an object.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb195-1"><a href="LogRegAnalysis.html#cb195-1" aria-hidden="true" tabindex="-1"></a>glm.bliss <span class="ot">&lt;-</span> <span class="fu">glm</span>(outcome01<span class="sc">~</span>conc,<span class="at">data=</span>bliss,<span class="at">family=</span>binomial)</span></code></pre></div>
<div class="tip">
<p>Logistic regressions are fit in R with <code>glm()</code> rather than <code>lm()</code> because logistic regression is a <em>generalized</em> rather than a <em>general</em> linear model.</p>
</div>
</div>
<div id="LogRegParametersR" class="section level2" number="27.3">
<h2><span class="header-section-number">27.3</span> Parameter Estimates</h2>
<p>The estimated intercept and slope are extracted from the <code>glm()</code> object with <code>coef()</code>.</p>
<p>Confidence intervals constructed from bootstrap samples require bootstrap samples to be constructed first. There are many ways to construct bootstrap samples in R. We will use <code>Boot()</code> from the <code>car</code> package. This function will be called with <code>car::Boot()</code> so as to not have to load the whole <code>car</code> package. <code>Boot()</code> requires only the saved <code>glm()</code> object as its argument.<a href="#fn101" class="footnote-ref" id="fnref101"><sup>101</sup></a> The results of <code>car::Boot()</code> should be saved to an object.<a href="#fn102" class="footnote-ref" id="fnref102"><sup>102</sup></a></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb196-1"><a href="LogRegAnalysis.html#cb196-1" aria-hidden="true" tabindex="-1"></a>boot.bliss <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Boot</span>(glm.bliss)</span></code></pre></div>
<p>The bootstrap confidence intervals for the intercept and slope are extracted from the <code>Boot()</code> object with <code>confint()</code>. Include <code>type="perc"</code> to perform the last step of the bootstrap steps shown in Section <a href="LogRegModels.html#variability-estimates">26.5</a>.</p>
<p>As before, I like to combine the parameter estimates and confidence intervals into one presentation.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb197-1"><a href="LogRegAnalysis.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">Ests=</span><span class="fu">coef</span>(glm.bliss),<span class="fu">confint</span>(boot.bliss,<span class="at">type=</span><span class="st">&quot;perc&quot;</span>))</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;                      Ests       2.5 %      97.5 %
#R&gt;   (Intercept) -14.8229985 -17.6159611 -12.5704693
#R&gt;   conc          0.2494156   0.2126906   0.2967598</code></pre>
</div>
<div id="LogRegPredictionsR" class="section level2" number="27.4">
<h2><span class="header-section-number">27.4</span> Predictions</h2>
<div id="functions-for-bootstrapping" class="section level3" number="27.4.1">
<h3><span class="header-section-number">27.4.1</span> Functions for Bootstrapping</h3>
<p>The bootstrap method was introduced in Section <a href="LogRegModels.html#variability-estimates">26.5</a> as a way to estimate reliable confidence intervals for predicted probabilities and values of the explanatory variable for a given probability. Applying the bootstrap method for derived metrics like these requires specific functions to calculate the predicted probability for a given value of <span class="math inline">\(X\)</span> and the value of <span class="math inline">\(X\)</span> for a given probability. The <code>predProb()</code> below is the R version of</p>
<p><span class="math display">\[ p = \frac{e^{\alpha+\beta X}}{1+e^{\alpha+\beta X}} \]</span></p>
<p>from Module <a href="LogRegFoundations.html#LogRegFoundations">25</a> and <code>predX()</code> below is the R version of</p>
<p><span class="math display">\[ X = \frac{log\left(\frac{p}{1-p}\right)-\alpha}{\beta} \]</span></p>
<p>from Module <a href="LogRegModels.html#LogRegModels">26</a>.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb199-1"><a href="LogRegAnalysis.html#cb199-1" aria-hidden="true" tabindex="-1"></a>predProb <span class="ot">&lt;-</span> <span class="cf">function</span>(x,alpha,beta) <span class="fu">exp</span>(alpha<span class="sc">+</span>beta<span class="sc">*</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(alpha<span class="sc">+</span>beta<span class="sc">*</span>x))</span>
<span id="cb199-2"><a href="LogRegAnalysis.html#cb199-2" aria-hidden="true" tabindex="-1"></a>predX <span class="ot">&lt;-</span> <span class="cf">function</span>(p,alpha,beta) (<span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p))<span class="sc">-</span>alpha)<span class="sc">/</span>beta</span></code></pre></div>
<div class="tip">
<p>Copy the code for <code>predProb()</code> and <code>predX()</code> as shown above directly into the beginning of your logistic regression script.</p>
</div>
</div>
<div id="predictions-2" class="section level3" number="27.4.2">
<h3><span class="header-section-number">27.4.2</span> Predictions</h3>
<p>The predicted log odds of mortality given a value of the concentration of calcium disulphide is found with <code>predict()</code>, similar to what was shown in previous modules. For example, the code below finds the log odds of mortality for a concentration of 70 mg/liter.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb200-1"><a href="LogRegAnalysis.html#cb200-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">conc=</span><span class="dv">70</span>)</span>
<span id="cb200-2"><a href="LogRegAnalysis.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(glm.bliss,<span class="at">newdata=</span>nd)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;          1 
#R&gt;   2.636094</code></pre>
<p>The probability, rather than log odds, can be found by including <code>type=response</code> in <code>predict()</code>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb202-1"><a href="LogRegAnalysis.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(glm.bliss,<span class="at">newdata=</span>nd,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;           1 
#R&gt;   0.9331487</code></pre>
<p>Unfortunately, confidence intervals for this prediction can not be constructed with <code>predict()</code>. Bootstrap confidence intervals, however, can be constructed using <code>predProb()</code> and the data frame of bootstrapped intercepts and slopes saved earlier. This is a bit of work so, lets work through this step-by-step.</p>
<p>First, the boostrapped data is in the <code>t</code> object of the <code>Boot</code> object saved above.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb204-1"><a href="LogRegAnalysis.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boot.bliss<span class="sc">$</span>t)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;        (Intercept)      conc
#R&gt;   [1,]   -14.49102 0.2451659
#R&gt;   [2,]   -15.52964 0.2605145
#R&gt;   [3,]   -16.45376 0.2746857
#R&gt;   [4,]   -14.58048 0.2469224
#R&gt;   [5,]   -15.27241 0.2567067
#R&gt;   [6,]   -15.56794 0.2617828</code></pre>
<p>The intercepts are in the first column and the slopes are in the second. For example, you could see just the vector of slopes with <code>boot.bliss$t[,2]</code> (rounded below to save space)</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb206-1"><a href="LogRegAnalysis.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(boot.bliss<span class="sc">$</span>t[,<span class="dv">2</span>],<span class="dv">2</span>)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;     [1] 0.25 0.26 0.27 0.25 0.26 0.26 0.27 0.24 0.25 0.24 0.28 0.23 0.26 0.24 0.23
#R&gt;    [16] 0.26 0.26 0.25 0.24 0.26 0.26 0.24 0.23 0.24 0.25 0.25 0.21 0.25 0.26 0.29
#R&gt;    [31] 0.27 0.25 0.22 0.22 0.24 0.29 0.28 0.24 0.21 0.28 0.26 0.24 0.28 0.26 0.25
#R&gt;    [46] 0.24 0.28 0.23 0.27 0.22 0.26 0.26 0.27 0.22 0.23 0.23 0.23 0.26 0.25 0.26
#R&gt;    [61] 0.24 0.24 0.26 0.25 0.21 0.25 0.28 0.22 0.23 0.27 0.25 0.23 0.26 0.26 0.25
#R&gt;    [76] 0.23 0.27 0.24 0.25 0.24 0.24 0.26 0.26 0.26 0.27 0.24 0.28 0.26 0.25 0.25
#R&gt;    [91] 0.23 0.24 0.21 0.24 0.25 0.24 0.25 0.26 0.23 0.23 0.27 0.26 0.25 0.24 0.26
#R&gt;   [106] 0.23 0.26 0.24 0.27 0.26 0.27 0.25 0.26 0.25 0.26 0.26 0.23 0.23 0.30 0.27
#R&gt;   [121] 0.24 0.23 0.23 0.24 0.28 0.26 0.24 0.25 0.24 0.25 0.25 0.26 0.26 0.22 0.25
#R&gt;   [136] 0.24 0.25 0.23 0.22 0.26 0.24 0.24 0.27 0.25 0.24 0.26 0.24 0.27 0.28 0.25
#R&gt;   [151] 0.30 0.25 0.26 0.22 0.27 0.21 0.30 0.29 0.23 0.25 0.25 0.26 0.23 0.26 0.22
#R&gt;   [166] 0.26 0.28 0.24 0.25 0.27 0.25 0.30 0.25 0.25 0.24 0.26 0.28 0.30 0.27 0.23
#R&gt;   [181] 0.29 0.26 0.24 0.24 0.24 0.23 0.22 0.26 0.21 0.25 0.26 0.28 0.27 0.23 0.27
#R&gt;   [196] 0.23 0.24 0.22 0.30 0.24 0.29 0.25 0.25 0.27 0.22 0.25 0.25 0.24 0.26 0.28
#R&gt;   [211] 0.26 0.34 0.26 0.27 0.25 0.22 0.23 0.27 0.23 0.24 0.26 0.24 0.23 0.22 0.18
#R&gt;   [226] 0.28 0.27 0.25 0.27 0.26 0.26 0.24 0.27 0.26 0.25 0.21 0.26 0.24 0.23 0.20
#R&gt;   [241] 0.27 0.25 0.21 0.21 0.25 0.24 0.22 0.25 0.23 0.26 0.19 0.23 0.25 0.25 0.27
#R&gt;   [256] 0.26 0.27 0.24 0.29 0.26 0.23 0.27 0.26 0.26 0.24 0.24 0.23 0.33 0.25 0.27
#R&gt;   [271] 0.22 0.21 0.27 0.20 0.23 0.25 0.30 0.27 0.30 0.24 0.22 0.23 0.22 0.29 0.25
#R&gt;   [286] 0.24 0.28 0.24 0.25 0.26 0.25 0.26 0.26 0.27 0.25 0.23 0.23 0.24 0.29 0.25
#R&gt;   [301] 0.28 0.27 0.23 0.22 0.25 0.27 0.26 0.25 0.26 0.26 0.23 0.28 0.25 0.25 0.26
#R&gt;   [316] 0.26 0.25 0.26 0.27 0.23 0.28 0.29 0.26 0.27 0.24 0.25 0.28 0.30 0.24 0.30
#R&gt;   [331] 0.28 0.23 0.27 0.26 0.25 0.27 0.27 0.26 0.23 0.28 0.25 0.24 0.24 0.26 0.25
#R&gt;   [346] 0.22 0.25 0.23 0.24 0.24 0.25 0.28 0.25 0.28 0.21 0.23 0.24 0.25 0.24 0.26
#R&gt;   [361] 0.27 0.26 0.25 0.24 0.24 0.32 0.23 0.26 0.24 0.26 0.23 0.25 0.23 0.30 0.24
#R&gt;   [376] 0.24 0.22 0.23 0.29 0.30 0.25 0.29 0.24 0.24 0.25 0.23 0.30 0.26 0.24 0.24
#R&gt;   [391] 0.22 0.24 0.24 0.24 0.23 0.26 0.25 0.25 0.24 0.23 0.27 0.27 0.29 0.29 0.25
#R&gt;   [406] 0.26 0.27 0.24 0.22 0.25 0.24 0.24 0.26 0.23 0.26 0.27 0.27 0.24 0.25 0.29
#R&gt;   [421] 0.24 0.24 0.26 0.22 0.26 0.26 0.28 0.22 0.27 0.23 0.22 0.25 0.23 0.29 0.25
#R&gt;   [436] 0.24 0.26 0.27 0.23 0.27 0.23 0.30 0.23 0.23 0.28 0.24 0.28 0.21 0.24 0.20
#R&gt;   [451] 0.24 0.22 0.24 0.27 0.27 0.26 0.26 0.27 0.25 0.28 0.24 0.26 0.26 0.27 0.25
#R&gt;   [466] 0.25 0.23 0.20 0.23 0.25 0.24 0.24 0.25 0.28 0.25 0.27 0.26 0.26 0.28 0.24
#R&gt;   [481] 0.26 0.25 0.26 0.24 0.27 0.24 0.28 0.24 0.24 0.27 0.22 0.27 0.25 0.25 0.23
#R&gt;   [496] 0.26 0.24 0.22 0.27 0.28 0.21 0.23 0.27 0.28 0.24 0.23 0.26 0.23 0.22 0.24
#R&gt;   [511] 0.24 0.23 0.29 0.24 0.26 0.26 0.27 0.25 0.25 0.24 0.25 0.26 0.29 0.23 0.28
#R&gt;   [526] 0.25 0.24 0.24 0.24 0.23 0.22 0.25 0.22 0.25 0.22 0.25 0.25 0.25 0.27 0.22
#R&gt;   [541] 0.28 0.26 0.28 0.25 0.24 0.28 0.25 0.25 0.24 0.25 0.26 0.27 0.23 0.23 0.24
#R&gt;   [556] 0.26 0.23 0.23 0.28 0.28 0.25 0.24 0.24 0.25 0.28 0.23 0.26 0.27 0.22 0.23
#R&gt;   [571] 0.26 0.23 0.22 0.23 0.25 0.23 0.25 0.26 0.30 0.24 0.22 0.26 0.25 0.25 0.24
#R&gt;   [586] 0.26 0.26 0.27 0.27 0.24 0.28 0.22 0.27 0.28 0.25 0.23 0.26 0.25 0.26 0.26
#R&gt;   [601] 0.26 0.26 0.25 0.26 0.23 0.25 0.26 0.27 0.28 0.23 0.27 0.24 0.25 0.25 0.29
#R&gt;   [616] 0.25 0.23 0.24 0.23 0.24 0.24 0.26 0.25 0.25 0.31 0.23 0.20 0.30 0.24 0.27
#R&gt;   [631] 0.24 0.26 0.23 0.29 0.26 0.25 0.25 0.26 0.22 0.24 0.26 0.24 0.23 0.26 0.27
#R&gt;   [646] 0.27 0.25 0.24 0.23 0.21 0.24 0.23 0.24 0.23 0.27 0.27 0.26 0.26 0.25 0.25
#R&gt;   [661] 0.27 0.23 0.26 0.22 0.25 0.24 0.24 0.26 0.26 0.28 0.21 0.26 0.25 0.24 0.29
#R&gt;   [676] 0.25 0.21 0.24 0.23 0.26 0.25 0.26 0.22 0.28 0.25 0.26 0.28 0.25 0.24 0.25
#R&gt;   [691] 0.30 0.29 0.27 0.22 0.27 0.26 0.25 0.22 0.28 0.24 0.22 0.24 0.22 0.27 0.29
#R&gt;   [706] 0.26 0.22 0.23 0.25 0.28 0.26 0.27 0.27 0.24 0.23 0.26 0.25 0.24 0.29 0.25
#R&gt;   [721] 0.22 0.28 0.28 0.27 0.26 0.24 0.25 0.27 0.27 0.23 0.26 0.25 0.21 0.26 0.24
#R&gt;   [736] 0.24 0.27 0.23 0.24 0.25 0.23 0.24 0.25 0.28 0.26 0.22 0.23 0.25 0.29 0.24
#R&gt;   [751] 0.26 0.26 0.25 0.22 0.22 0.25 0.21 0.28 0.25 0.23 0.24 0.26 0.26 0.25 0.26
#R&gt;   [766] 0.28 0.27 0.21 0.22 0.21 0.24 0.22 0.25 0.26 0.27 0.25 0.24 0.22 0.24 0.28
#R&gt;   [781] 0.26 0.25 0.29 0.27 0.26 0.23 0.26 0.28 0.24 0.24 0.22 0.24 0.25 0.25 0.24
#R&gt;   [796] 0.27 0.22 0.22 0.21 0.24 0.28 0.24 0.26 0.28 0.26 0.24 0.28 0.24 0.27 0.21
#R&gt;   [811] 0.26 0.28 0.26 0.28 0.25 0.25 0.27 0.28 0.24 0.22 0.25 0.25 0.23 0.25 0.24
#R&gt;   [826] 0.25 0.25 0.22 0.26 0.26 0.22 0.24 0.25 0.26 0.21 0.25 0.25 0.26 0.21 0.25
#R&gt;   [841] 0.23 0.22 0.24 0.21 0.24 0.27 0.29 0.27 0.22 0.26 0.24 0.25 0.22 0.27 0.23
#R&gt;   [856] 0.25 0.28 0.27 0.25 0.27 0.24 0.25 0.27 0.24 0.25 0.26 0.23 0.35 0.23 0.25
#R&gt;   [871] 0.24 0.22 0.26 0.26 0.27 0.24 0.24 0.24 0.23 0.25 0.26 0.24 0.27 0.22 0.27
#R&gt;   [886] 0.24 0.24 0.25 0.24 0.25 0.24 0.25 0.24 0.31 0.22 0.28 0.24 0.28 0.24 0.26
#R&gt;   [901] 0.23 0.30 0.24 0.25 0.27 0.24 0.24 0.25 0.29 0.21 0.27 0.27 0.20 0.27 0.27
#R&gt;   [916] 0.28 0.30 0.24 0.24 0.21 0.25 0.25 0.22 0.25 0.33 0.22 0.26 0.26 0.25 0.26
#R&gt;   [931] 0.26 0.21 0.28 0.27 0.22 0.22 0.24 0.30 0.26 0.23 0.26 0.30 0.28 0.24 0.23
#R&gt;   [946] 0.26 0.24 0.23 0.23 0.25 0.26 0.29 0.21 0.21 0.26 0.27 0.25 0.26 0.30 0.26
#R&gt;   [961] 0.24 0.27 0.23 0.23 0.26 0.24 0.24 0.27 0.23 0.27 0.25 0.24 0.26 0.26 0.26
#R&gt;   [976] 0.24 0.23 0.24 0.26 0.26 0.26 0.24 0.29 0.26 0.26 0.24 0.31 0.27 0.27 0.22
#R&gt;   [991] 0.27 0.24 0.23 0.22 0.27 0.27 0.26 0.26 0.25</code></pre>
<p>Second, note that <code>predProb()</code> takes a value of <span class="math inline">\(X\)</span> at which to make the prediction as its first argument, an intercept as the second argument, and the slope as the third argument. If this function is given <strong>all</strong> of the bootstrapped intercepts and slopes then it will make a prediction at the supplied value of <code>x</code> for each bootstrapped sample. For example, the code below computes the predicted probability of mortality at a concentration of 70 mg/L for each bootstrapped sample and then examines the first six of those values.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb208-1"><a href="LogRegAnalysis.html#cb208-1" aria-hidden="true" tabindex="-1"></a>p70 <span class="ot">&lt;-</span> <span class="fu">predProb</span>(<span class="dv">70</span>,boot.bliss<span class="sc">$</span>t[,<span class="dv">1</span>],boot.bliss<span class="sc">$</span>t[,<span class="dv">2</span>])</span>
<span id="cb208-2"><a href="LogRegAnalysis.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(p70)</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;   [1] 0.9352690 0.9374018 0.9412677 0.9372674 0.9368530 0.9402995</code></pre>
<p>The 95% bootstrapped confidence interval is between the two values in <code>p70</code> that have 2.5% and 97.5% of the values lower. These values are found with <code>quantile()</code> given the vector of values as the first argument, the percentages to “cut off” at as proportions in <code>probs=</code>, and <code>type=1</code> so that the quantiles computed here are the same as those in <code>confint()</code> above. For example, the 95% confidence interval for the predicted probability for a concentration of 70 mg/L is computed with</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb210-1"><a href="LogRegAnalysis.html#cb210-1" aria-hidden="true" tabindex="-1"></a>( ci70 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(p70,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)) )</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;        2.5%     97.5% 
#R&gt;   0.9032931 0.9581815</code></pre>
<p>Thus, one is 95% confident that the predicted probability of mortality for beetles exposed to 70 mg/l calcium disulphide is between 0.903 and 0.958.</p>
<p>A similar process is used to predict the concentration where 50%, for example, of the beetles will have died, except that <code>predX()</code> from above is used and it requires the probability of interest as a proportion as the first argument.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb212-1"><a href="LogRegAnalysis.html#cb212-1" aria-hidden="true" tabindex="-1"></a>x50 <span class="ot">&lt;-</span> <span class="fu">predX</span>(<span class="fl">0.5</span>,boot.bliss<span class="sc">$</span>t[,<span class="dv">1</span>],boot.bliss<span class="sc">$</span>t[,<span class="dv">2</span>])</span>
<span id="cb212-2"><a href="LogRegAnalysis.html#cb212-2" aria-hidden="true" tabindex="-1"></a>( ci50 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x50,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)) )</span></code></pre></div>
<pre class="ROUTPUT"><code>#R&gt;       2.5%    97.5% 
#R&gt;   58.31069 60.44455</code></pre>
<p>Thus, one is 95% confident that the predicted concentration where 50% of the beetles would be dead is between 58.3 and 60.4.</p>
<p> </p>
</div>
</div>
<div id="plotting-best-fit-line" class="section level2" number="27.5">
<h2><span class="header-section-number">27.5</span> Plotting Best-Fit Line</h2>
<p>The code below is used to construct a fitted-line plot for the logistic regression. The <code>alpha=</code> argument in <code>geom_point()</code> is used to make the points semi-transparent. This is important here because many points will be plotted on top of each other. With semi-transparency the visible “point” will become darker as more points are plotted on top of each other. You may need to try different values for <code>alpha=</code> (smaller values are more transparent). Also note that <code>geom_smooth</code> uses <code>method="glm"</code> instead of <code>lm</code>. The <code>method.args=</code> can be copied directly, but note that this just supplies the <code>family=</code> argument to <code>glm()</code> within <code>geom_smooth()</code>.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r RCODE"><code class="sourceCode r"><span id="cb214-1"><a href="LogRegAnalysis.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>bliss,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>conc,<span class="at">y=</span>outcome01)) <span class="sc">+</span></span>
<span id="cb214-2"><a href="LogRegAnalysis.html#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb214-3"><a href="LogRegAnalysis.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>,<span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span>binomial)) <span class="sc">+</span></span>
<span id="cb214-4"><a href="LogRegAnalysis.html#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Concentration of Disulphide&quot;</span>,<span class="at">y=</span><span class="st">&quot;Probability of Mortality&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-5"><a href="LogRegAnalysis.html#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_NCStats</span>()</span></code></pre></div>
<p><img src="Book207_files/figure-html/unnamed-chunk-167-1.png" width="336" style="display: block; margin: auto;" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="100">
<li id="fn100"><p>Note that R uses <code>==</code> when asking if two things are equal. So the condition in this <code>ifelse()</code> is asking where the <code>oucome</code> variable in <code>bliss</code> is equal to <code>dead</code>.<a href="LogRegAnalysis.html#fnref100" class="footnote-back">↩︎</a></p></li>
<li id="fn101"><p>The number of bootstrap samples defaults to 999, which is adequate for our purposes. This number of bootstrap samples can be modified with <code>R=</code>.<a href="LogRegAnalysis.html#fnref101" class="footnote-back">↩︎</a></p></li>
<li id="fn102"><p><code>Boot()</code> may take many seconds to run, depending on the size of the original data frame and the number of bootstrapped samples taken.<a href="LogRegAnalysis.html#fnref102" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="LogRegModels.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="LogRegSummary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
